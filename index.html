<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Kanit&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css"
    />
    <style>
      body {
        font-family: "Kanit", sans-serif;
      }
      .glow-green {
        text-shadow: 0 0 5px rgba(74, 222, 128, 0.8),
                     0 0 10px rgba(74, 222, 128, 0.6),
                     0 0 15px rgba(74, 222, 128, 0.4);
      }
      .glow-blue {
        text-shadow: 0 0 5px rgba(59, 130, 246, 0.8),
                     0 0 10px rgba(59, 130, 246, 0.6),
                     0 0 15px rgba(59, 130, 246, 0.4);
      }
      .glow-pink {
        text-shadow: 0 0 5px rgba(236, 72, 153, 0.8),
                     0 0 10px rgba(236, 72, 153, 0.6),
                     0 0 15px rgba(236, 72, 153, 0.4);
      }
      select:focus,
      input:focus {
        box-shadow: 0 0 8px rgba(74, 222, 128, 0.5);
      }
      #statsChart {
        max-width: 100%;
        height: auto;
      }
    </style>
  </head>

  <body class="bg-gradient-to-br from-gray-900 to-black text-white min-h-screen flex flex-col items-center justify-center p-4 sm:p-6">
    <div class="text-center mb-6">
      <img
        src="https://lh3.googleusercontent.com/d/1hTcB5YnvnJtMg0l4fIO5Jo20QbKF5_wh"
        class="w-32 h-auto mb-4 mx-auto"
      />
      <h3 class="text-2xl sm:text-3xl font-bold glow-green">
        ‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô
      </h3>
      <h5 class="text-lg sm:text-xl text-pink-400 glow-pink">
        ‡∏Ñ‡∏£‡∏π‡∏≠‡∏±‡πã‡∏ô ‡πÉ‡∏à‡∏î‡∏µ
      </h5>
    </div>

    <div class="w-full max-w-2xl bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-2xl shadow-green-500/20 transform hover:-translate-y-1 transition-transform duration-300">
      <form id="myForm" class="space-y-4 needs-validation" novalidate>
        <div>
          <label for="nameTeacher" class="block text-sm font-medium glow-blue">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏•‡∏≤‡∏™‡∏≠‡∏ô</label>
          <select
            id="nameTeacher"
            name="nameTeacher"
            class="w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-white focus:border-green-400 focus:ring-0 transition duration-200"
            required
          >
            <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏•‡∏≤‡∏™‡∏≠‡∏ô</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏≤‡∏£‡∏µ ‡∏ö‡∏±‡∏ß‡∏Ñ‡∏∏‡πâ‡∏°‡∏†‡∏±‡∏¢">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏≤‡∏£‡∏µ ‡∏ö‡∏±‡∏ß‡∏Ñ‡∏∏‡πâ‡∏°‡∏†‡∏±‡∏¢</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò‡πå ‡πÑ‡∏ó‡∏£‡∏¢‡πâ‡∏≠‡∏¢‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏•‡∏¥‡∏®">‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò‡πå ‡πÑ‡∏ó‡∏£‡∏¢‡πâ‡∏≠‡∏¢‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏•‡∏¥‡∏®</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏†‡∏±‡∏ó‡∏£‡∏û‡∏á‡∏®‡πå ‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå">‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏†‡∏±‡∏ó‡∏£‡∏û‡∏á‡∏®‡πå ‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏õ‡∏ô‡∏±‡∏®‡∏ç‡∏≤ ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏°‡∏≤‡∏Å">‡∏ô‡∏≤‡∏á‡∏õ‡∏ô‡∏±‡∏®‡∏ç‡∏≤ ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏°‡∏≤‡∏Å</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ß‡∏≤‡∏ì‡∏µ ‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏£‡∏µ">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ß‡∏≤‡∏ì‡∏µ ‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏£‡∏µ</option>
            <option value="‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏†‡∏≤‡∏£‡∏¥‡∏©‡∏≤ ‡∏ò‡∏ô‡∏™‡∏¥‡∏£‡∏¥‡∏á‡∏≤‡∏°">‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏†‡∏≤‡∏£‡∏¥‡∏©‡∏≤ ‡∏ò‡∏ô‡∏™‡∏¥‡∏£‡∏¥‡∏á‡∏≤‡∏°</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏°‡∏ì‡∏ë‡∏≤‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡∏Ñ‡∏µ‡∏£‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ß‡∏á‡∏®‡πå">‡∏ô‡∏≤‡∏á‡∏°‡∏ì‡∏ë‡∏≤‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡∏Ñ‡∏µ‡∏£‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ß‡∏á‡∏®‡πå</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏õ‡∏≤‡∏ì‡∏µ ‡∏≠‡∏¥‡∏ô‡∏≠‡∏á‡∏Å‡∏≤‡∏£">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏õ‡∏≤‡∏ì‡∏µ ‡∏≠‡∏¥‡∏ô‡∏≠‡∏á‡∏Å‡∏≤‡∏£</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏∏‡∏ä‡∏ô‡∏≤‡∏è ‡πÅ‡∏ñ‡∏•‡∏á‡∏™‡∏±‡∏ï‡∏¢‡πå">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏∏‡∏ä‡∏ô‡∏≤‡∏è ‡πÅ‡∏ñ‡∏•‡∏á‡∏™‡∏±‡∏ï‡∏¢‡πå</option>
            <option value="‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏≠‡∏∏‡∏ö‡∏•‡∏ß‡∏£‡∏£‡∏ì ‡∏Å‡∏±‡∏ô‡∏ï‡∏∞‡πÅ‡∏Å‡πâ‡∏ß">‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏≠‡∏∏‡∏ö‡∏•‡∏ß‡∏£‡∏£‡∏ì ‡∏Å‡∏±‡∏ô‡∏ï‡∏∞‡πÅ‡∏Å‡πâ‡∏ß</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏• ‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå">‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏• ‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå ‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏±‡πà‡∏ô">‡∏ô‡∏≤‡∏¢‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå ‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏±‡πà‡∏ô</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏û‡∏ä‡∏£‡∏ô‡∏†‡∏≤ ‡∏ú‡∏≤‡∏î‡∏ú‡πà‡∏≠‡∏á">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏û‡∏ä‡∏£‡∏ô‡∏†‡∏≤ ‡∏ú‡∏≤‡∏î‡∏ú‡πà‡∏≠‡∏á</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏±‡∏ó‡∏ß‡∏±‡∏ô ‡∏®‡∏£‡∏µ‡∏†‡∏±‡∏Å‡∏î‡∏µ">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏±‡∏ó‡∏ß‡∏±‡∏ô ‡∏®‡∏£‡∏µ‡∏†‡∏±‡∏Å‡∏î‡∏µ</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏™‡∏£‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏™‡∏≤‡∏¢‡∏î‡∏µ">‡∏ô‡∏≤‡∏¢‡∏™‡∏£‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏™‡∏≤‡∏¢‡∏î‡∏µ</option>
          </select>
          <div class="invalid-feedback text-red-500 text-sm mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏•‡∏≤‡∏™‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞</div>
        </div>
        <div>
          <label for="nameTeacherSave" class="block text-sm font-medium glow-blue">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</label>
          <select
            id="nameTeacherSave"
            name="nameTeacherSave"
            class="w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-white focus:border-green-400 focus:ring-0 transition duration-200"
            required
          >
            <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏≤‡∏£‡∏µ ‡∏ö‡∏±‡∏ß‡∏Ñ‡∏∏‡πâ‡∏°‡∏†‡∏±‡∏¢">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏≠‡∏≤‡∏£‡∏µ ‡∏ö‡∏±‡∏ß‡∏Ñ‡∏∏‡πâ‡∏°‡∏†‡∏±‡∏¢</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò‡πå ‡πÑ‡∏ó‡∏£‡∏¢‡πâ‡∏≠‡∏¢‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏•‡∏¥‡∏®">‡∏ô‡∏≤‡∏¢‡∏õ‡∏£‡∏∞‡∏¢‡∏∏‡∏ó‡∏ò‡πå ‡πÑ‡∏ó‡∏£‡∏¢‡πâ‡∏≠‡∏¢‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏•‡∏¥‡∏®</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏†‡∏±‡∏ó‡∏£‡∏û‡∏á‡∏®‡πå ‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå">‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏†‡∏±‡∏ó‡∏£‡∏û‡∏á‡∏®‡πå ‡∏£‡∏ß‡∏á‡∏ú‡∏∂‡πâ‡∏á‡∏£‡∏∏‡πà‡∏á‡πÇ‡∏£‡∏à‡∏ô‡πå</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏õ‡∏ô‡∏±‡∏®‡∏ç‡∏≤ ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏°‡∏≤‡∏Å">‡∏ô‡∏≤‡∏á‡∏õ‡∏ô‡∏±‡∏®‡∏ç‡∏≤ ‡πÄ‡∏à‡∏£‡∏¥‡∏ç‡∏°‡∏≤‡∏Å</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ß‡∏≤‡∏ì‡∏µ ‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏£‡∏µ">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ß‡∏≤‡∏ì‡∏µ ‡∏ò‡∏£‡∏£‡∏°‡∏®‡∏£‡∏µ</option>
            <option value="‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏†‡∏≤‡∏£‡∏¥‡∏©‡∏≤ ‡∏ò‡∏ô‡∏™‡∏¥‡∏£‡∏¥‡∏á‡∏≤‡∏°">‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏†‡∏≤‡∏£‡∏¥‡∏©‡∏≤ ‡∏ò‡∏ô‡∏™‡∏¥‡∏£‡∏¥‡∏á‡∏≤‡∏°</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏°‡∏ì‡∏ë‡∏≤‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡∏Ñ‡∏µ‡∏£‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ß‡∏á‡∏®‡πå">‡∏ô‡∏≤‡∏á‡∏°‡∏ì‡∏ë‡∏≤‡∏ó‡∏¥‡∏û‡∏¢‡πå ‡∏Ñ‡∏µ‡∏£‡∏µ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏ß‡∏á‡∏®‡πå</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏õ‡∏≤‡∏ì‡∏µ ‡∏≠‡∏¥‡∏ô‡∏≠‡∏á‡∏Å‡∏≤‡∏£">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏õ‡∏≤‡∏ì‡∏µ ‡∏≠‡∏¥‡∏ô‡∏≠‡∏á‡∏Å‡∏≤‡∏£</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏∏‡∏ä‡∏ô‡∏≤‡∏è ‡πÅ‡∏ñ‡∏•‡∏á‡∏™‡∏±‡∏ï‡∏¢‡πå">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏ô‡∏∏‡∏ä‡∏ô‡∏≤‡∏è ‡πÅ‡∏ñ‡∏•‡∏á‡∏™‡∏±‡∏ï‡∏¢‡πå</option>
            <option value="‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏≠‡∏∏‡∏ö‡∏•‡∏ß‡∏£‡∏£‡∏ì ‡∏Å‡∏±‡∏ô‡∏ï‡∏∞‡πÅ‡∏Å‡πâ‡∏ß">‡∏ß‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏¢‡∏ï‡∏£‡∏µ‡∏´‡∏ç‡∏¥‡∏á‡∏≠‡∏∏‡∏ö‡∏•‡∏ß‡∏£‡∏£‡∏ì ‡∏Å‡∏±‡∏ô‡∏ï‡∏∞‡πÅ‡∏Å‡πâ‡∏ß</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏• ‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå">‡∏ô‡∏≤‡∏¢‡∏ì‡∏±‡∏ê‡∏û‡∏• ‡πÄ‡∏ô‡∏µ‡∏¢‡∏°‡∏û‡∏¥‡∏ó‡∏±‡∏Å‡∏©‡πå</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå ‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏±‡πà‡∏ô">‡∏ô‡∏≤‡∏¢‡∏™‡∏±‡∏°‡∏§‡∏ó‡∏ò‡∏¥‡πå ‡∏°‡∏µ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏°‡∏±‡πà‡∏ô</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏û‡∏ä‡∏£‡∏ô‡∏†‡∏≤ ‡∏ú‡∏≤‡∏î‡∏ú‡πà‡∏≠‡∏á">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡πÄ‡∏û‡∏ä‡∏£‡∏ô‡∏†‡∏≤ ‡∏ú‡∏≤‡∏î‡∏ú‡πà‡∏≠‡∏á</option>
            <option value="‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏±‡∏ó‡∏ß‡∏±‡∏ô ‡∏®‡∏£‡∏µ‡∏†‡∏±‡∏Å‡∏î‡∏µ">‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏°‡∏±‡∏ó‡∏ß‡∏±‡∏ô ‡∏®‡∏£‡∏µ‡∏†‡∏±‡∏Å‡∏î‡∏µ</option>
            <option value="‡∏ô‡∏≤‡∏¢‡∏™‡∏£‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏™‡∏≤‡∏¢‡∏î‡∏µ">‡∏ô‡∏≤‡∏¢‡∏™‡∏£‡∏ô‡∏±‡∏ô‡∏ó‡πå ‡∏™‡∏≤‡∏¢‡∏î‡∏µ</option>
          </select>
          <div class="invalid-feedback text-red-500 text-sm mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞</div>
        </div>
        <div>
          <label for="numberPeriod" class="block text-sm font-medium glow-blue">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</label>
          <select
            id="numberPeriod"
            name="numberPeriod"
            class="w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-white focus:border-green-400 focus:ring-0 transition duration-200"
            required
          >
            <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≤‡∏ö</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
          </select>
          <div class="invalid-feedback text-red-500 text-sm mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≤‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞</div>
        </div>
        <div>
          <label for="numberAtPreriod" class="block text-sm font-medium glow-blue">‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</label>
          <select
            id="numberAtPreriod"
            name="numberAtPreriod"
            class="w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-white focus:border-green-400 focus:ring-0 transition duration-200"
            required
          >
            <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
          </select>
          <div class="invalid-feedback text-red-500 text-sm mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞</div>
        </div>
        <div>
          <label for="subjectSave" class="block text-sm font-medium glow-blue">‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</label>
          <input
            type="text"
            id="subjectSave"
            name="subjectSave"
            class="w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-white focus:border-green-400 focus:ring-0 transition duration-200"
            value="‡∏ó"
            placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô"
            required
          />
          <div class="invalid-feedback text-red-500 text-sm mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞</div>
        </div>
        <div>
          <label for="subjectRoom" class="block text-sm font-medium glow-blue">‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô</label>
          <input
            type="text"
            id="subjectRoom"
            name="subjectRoom"
            class="w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-white focus:border-green-400 focus:ring-0 transition duration-200"
            placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô"
            required
          />
          <div class="invalid-feedback text-red-500 text-sm mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞</div>
        </div>
        <div class="flex space-x-4">
          <button
            type="submit"
            class="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-semibold py-3 rounded-lg flex items-center justify-center gap-2 transition duration-200 hover:-translate-y-1 disabled:bg-gray-600 disabled:cursor-not-allowed"
            id="btn1"
          >
            <i class="bi bi-send-fill"></i> ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
          </button>
          <button
            type="button"
            class="flex-1 bg-blue-600 text-white font-semibold py-3 rounded-lg flex items-center justify-center gap-2 transition duration-200 hover:-translate-y-1 disabled:bg-gray-600 disabled:cursor-not-allowed"
            id="btn2"
            style="display: none"
            disabled
          >
            <i class="bi bi-send-fill"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô...
          </button>
        </div>
      </form>

      <div class="mt-8 space-y-4">
        <div>
          <label for="checkDay" class="block text-sm font-medium glow-blue">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡πà‡∏≤‡∏á</label>
          <select
            id="checkDay"
            name="checkDay"
            class="w-full bg-gray-700 border-2 border-gray-600 rounded-lg p-3 text-white focus:border-green-400 focus:ring-0 transition duration-200"
            required
          >
            <option value="" disabled selected>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô</option>
            <option value="‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå">‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå</option>
            <option value="‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£">‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£</option>
            <option value="‡∏û‡∏∏‡∏ò">‡∏û‡∏∏‡∏ò</option>
            <option value="‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ">‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ</option>
            <option value="‡∏®‡∏∏‡∏Å‡∏£‡πå">‡∏®‡∏∏‡∏Å‡∏£‡πå</option>
          </select>
          <div class="invalid-feedback text-red-500 text-sm mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏∞</div>
        </div>
        <div class="flex space-x-4">
          <button
            type="button"
            class="flex-1 bg-blue-600 hover:bg-blue-500 text-white font-semibold py-3 rounded-lg flex items-center justify-center gap-2 transition duration-200 hover:-translate-y-1"
            id="checkAvailabilityBtn"
          >
            <i class="bi bi-calendar-check"></i> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏≤‡∏ö‡∏ß‡πà‡∏≤‡∏á
          </button>
          <button
            type="button"
            class="flex-1 bg-purple-600 hover:bg-purple-500 text-white font-semibold py-3 rounded-lg flex items-center justify-center gap-2 transition duration-200 hover:-translate-y-1"
            id="showStatsChartBtn"
          >
            <i class="bi bi-bar-chart-fill"></i> ‡∏î‡∏π‡∏Å‡∏£‡∏≤‡∏ü‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥
          </button>
        </div>
      </div>

      <div class="mt-8 hidden" id="chartContainer">
        <canvas id="statsChart" class="w-full"></canvas>
      </div>
    </div>

    <footer class="fixed bottom-0 w-full bg-gray-900 bg-opacity-80 backdrop-blur-sm text-center py-4 text-sm glow-pink">
      <img
        src="https://aliyahaunjo.github.io/image/kruaun.png"
        class="inline w-6 h-auto mr-2"
      />
      ¬©Ô∏è‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‡∏Ñ‡∏£‡∏π‡∏≠‡∏±‡πã‡∏ô ‡πÉ‡∏à‡∏î‡∏µ <span id="year"></span>
    </footer>

    <div class="text-center py-4 text-sm glow-pink">
      ¬© <span id="year2"></span> Dev By | ‡∏Ñ‡∏£‡∏π‡∏≠‡∏±‡πã‡∏ô ‡πÉ‡∏à‡∏î‡∏µ
    </div>

    <script>
      const scriptUrl = "https://script.google.com/macros/s/AKfycbxBsq2iZg7hu61ZUB__uhxYPt2vsHripo-9FGhjBScgORJ7vpTutgEbXtnRiNzIrLY7VQ/exec";

      $(document).ready(() => {
        $("#btn1").show();
        $("#btn2").hide();

        $("#year").text(new Date().getFullYear());
        $("#year2").text(new Date().getFullYear());

        liff
          .init({
            liffId: "2000563749-pzE08oM6",
            withLoginOnExternalBrowser: true,
          })
          .then(() => {
            console.log("LIFF Initialized Successfully");
            if (!liff.isLoggedIn()) {
              liff.login();
            }
          })
          .catch((err) => {
            console.error("LIFF Initialization Failed", err);
            Swal.fire({
              icon: "error",
              title: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE LIFF ‡πÑ‡∏î‡πâ",
              text: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà",
            });
          });

        $("#myForm select, #myForm input, #checkDay").on("input change", function () {
          if ($(this).is(":valid")) {
            $(this).css("border-color", "#4ade80");
          } else {
            $(this).css("border-color", "#ef4444");
          }
        });

        $("#checkAvailabilityBtn").on("click", checkAvailability);
        $("#showStatsChartBtn").on("click", showStatsChart);
      });

      function submitForm() {
        $("#btn1").hide();
        $("#btn2").show();
        $.LoadingOverlay("show");

        const data = {
          opt: "savedata",
          uid: liff.getDecodedIDToken()?.sub || "",
          uimg: liff.getDecodedIDToken()?.picture || "",
          nameTeacher: $("#nameTeacher").val(),
          nameTeacherSave: $("#nameTeacherSave").val(),
          numberPeriod: $("#numberPeriod").val(),
          numberAtPreriod: $("#numberAtPreriod").val(),
          subjectSave: $("#subjectSave").val(),
          subjectRoom: $("#subjectRoom").val(),
        };

        console.log("Submitting Data:", data);

        $.ajax({
          method: "POST",
          url: scriptUrl,
          data: data,
          dataType: "json",
          success: (res) => {
            $.LoadingOverlay("hide");
            $("#btn2").hide();
            $("#btn1").show();

            if (res.status === "success") {
              $("#myForm")[0].reset();
              Swal.fire({
                icon: "success",
                title: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢",
                text: "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á LINE...",
                confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
              }).then(() => {
                window.formData = data;
                shareForm();
              });
            } else {
              Swal.fire({
                icon: "error",
                title: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î",
                text: res.message || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ",
                confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
              });
            }
          },
          error: (err) => {
            console.error("Submission Error:", err);
            $.LoadingOverlay("hide");
            $("#btn2").hide();
            $("#btn1").show();
            Swal.fire({
              icon: "error",
              title: "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
              text: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á",
              confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
            });
          },
        });
      }

      function shareForm() {
        if (!window.formData) {
          Swal.fire({
            icon: "error",
            title: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ä‡∏£‡πå",
            text: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏ä‡∏£‡πå",
            confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
          });
          return;
        }

        const flexMessage = {
          type: "flex",
          altText: "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô",
          contents: {
            type: "bubble",
            styles: {
              header: { backgroundColor: "#1e3a8a" },
              body: { backgroundColor: "#1e3a4e" },
              footer: { backgroundColor: "#ec4899" },
            },
            header: {
              type: "box",
              layout: "vertical",
              contents: [
                {
                  type: "text",
                  text: "üìö ‡πÅ‡∏à‡πâ‡∏á‡∏à‡∏±‡∏î‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô",
                  weight: "bold",
                  size: "xl",
                  color: "#ffffff",
                  align: "center",
                },
              ],
              paddingAll: "lg",
            },
            body: {
              type: "box",
              layout: "vertical",
              contents: [
                {
                  type: "box",
                  layout: "horizontal",
                  contents: [
                    { type: "text", text: "üë©‚Äçüè´ ‡∏ú‡∏π‡πâ‡∏•‡∏≤‡∏™‡∏≠‡∏ô:", size: "sm", color: "#ffffff", flex: 2 },
                    {
                      type: "text",
                      text: window.formData.nameTeacher,
                      size: "sm",
                      color: "#ffffff",
                      wrap: true,
                      flex: 3,
                    },
                  ],
                  spacing: "sm",
                  margin: "md",
                },
                {
                  type: "box",
                  layout: "horizontal",
                  contents: [
                    { type: "text", text: "üë®‚Äçüè´ ‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô:", size: "sm", color: "#ffffff", flex: 2 },
                    {
                      type: "text",
                      text: window.formData.nameTeacherSave,
                      size: "sm",
                      color: "#ffffff",
                      wrap: true,
                      flex: 3,
                    },
                  ],
                  spacing: "sm",
                  margin: "md",
                },
                {
                  type: "box",
                  layout: "horizontal",
                  contents: [
                    { type: "text", text: "‚è∞ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≤‡∏ö:", size: "sm", color: "#ffffff", flex: 2 },
                    {
                      type: "text",
                      text: window.formData.numberPeriod,
                      size: "sm",
                      color: "#ffffff",
                      wrap: true,
                      flex: 3,
                    },
                  ],
                  spacing: "sm",
                  margin: "md",
                },
                {
                  type: "box",
                  layout: "horizontal",
                  contents: [
                    { type: "text", text: "üìÖ ‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà:", size: "sm", color: "#ffffff", flex: 2 },
                    {
                      type: "text",
                      text: window.formData.numberAtPreriod,
                      size: "sm",
                      color: "#ffffff",
                      wrap: true,
                      flex: 3,
                    },
                  ],
                  spacing: "sm",
                  margin: "md",
                },
                {
                  type: "box",
                  layout: "horizontal",
                  contents: [
                    { type: "text", text: "üìñ ‡∏ß‡∏¥‡∏ä‡∏≤:", size: "sm", color: "#ffffff", flex: 2 },
                    {
                      type: "text",
                      text: window.formData.subjectSave,
                      size: "sm",
                      color: "#ffffff",
                      wrap: true,
                      flex: 3,
                    },
                  ],
                  spacing: "sm",
                  margin: "md",
                },
                {
                  type: "box",
                  layout: "horizontal",
                  contents: [
                    { type: "text", text: "üè´ ‡∏´‡πâ‡∏≠‡∏á:", size: "sm", color: "#ffffff", flex: 2 },
                    {
                      type: "text",
                      text: window.formData.subjectRoom,
                      size: "sm",
                      color: "#ffffff",
                      wrap: true,
                      flex: 3,
                    },
                  ],
                  spacing: "sm",
                  margin: "md",
                },
              ],
              paddingAll: "lg",
            },
            footer: {
              type: "box",
              layout: "vertical",
              contents: [
                {
                  type: "text",
                  text: "‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ ‚ù§Ô∏è‡∏Ñ‡∏£‡∏π‡∏≠‡∏±‡πã‡∏ô ‡πÉ‡∏à‡∏î‡∏µ‚ù§Ô∏è",
                  size: "xs",
                  color: "#ffffff",
                  align: "center",
                },
              ],
              paddingAll: "md",
            },
          },
        };

        liff
          .shareTargetPicker([flexMessage])
          .then(() => {
            Swal.fire({
              icon: "success",
              title: "‡πÅ‡∏ä‡∏£‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
              text: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏õ‡∏¢‡∏±‡∏á LINE ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß",
              confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
            });
          })
          .catch((err) => {
            console.error("Share Error:", err);
            Swal.fire({
              icon: "error",
              title: "‡πÅ‡∏ä‡∏£‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à",
              text: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà",
              confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
            });
          });
      }

      function checkAvailability() {
        const day = $("#checkDay").val();

        if (!day) {
          Swal.fire({
            icon: "error",
            title: "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö",
            text: "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô",
            confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
          });
          return;
        }

        $.LoadingOverlay("show");

        $.ajax({
          method: "GET",
          url: scriptUrl,
          data: { opt: "getFreeTeachers" },
          dataType: "json",
          success: (res) => {
            $.LoadingOverlay("hide");
            if (res.status === "success" && res.data) {
              const teachers = res.data;
              let htmlContent = `<h3 class="text-lg font-bold glow-green">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ß‡∏±‡∏ô${day}</h3>`;
              let hasFreePeriods = false;

              teachers.forEach((teacher) => {
                const periodString = (teacher[day] || "")
                  .replace(/‡∏Ñ‡∏≤‡∏ö\s*/g, "")
                  .replace(/\s+/g, "");
                const freePeriods = periodString
                  .split(",")
                  .filter(
                    (period) =>
                      period.trim() !== "" && !isNaN(period) && period !== "0"
                  )
                  .map(Number)
                  .sort((a, b) => a - b);

                if (freePeriods.length > 0) {
                  hasFreePeriods = true;
                  htmlContent += `
                    <div class="mt-2">
                      <p class="text-sm"><strong>${teacher["‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏£‡∏π"]}</strong>: ‡∏Ñ‡∏≤‡∏ö ${freePeriods.join(", ")}</p>
                    </div>`;
                }
              });

              if (!hasFreePeriods) {
                htmlContent += `<p class="text-sm glow-pink">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡∏£‡∏π‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≤‡∏ö‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏ß‡∏±‡∏ô${day}</p>`;
              }

              Swal.fire({
                icon: hasFreePeriods ? "success" : "info",
                title: `‡∏Ñ‡∏≤‡∏ö‡∏ß‡πà‡∏≤‡∏á‡πÉ‡∏ô‡∏ß‡∏±‡∏ô${day}`,
                html: htmlContent,
                confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
              });
            } else {
              Swal.fire({
                icon: "error",
                title: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î",
                text: res.message || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏î‡πâ",
                confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
              });
            }
          },
          error: (err) => {
            console.error("Availability Check Error:", err);
            $.LoadingOverlay("hide");
            Swal.fire({
              icon: "error",
              title: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ß‡πà‡∏≤‡∏á",
              text: err.status === 0
                ? "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà"
                : "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà",
              confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
            });
          },
        });
      }

      function showStatsChart() {
        $.LoadingOverlay("show");

        $.ajax({
          method: "GET",
          url: scriptUrl,
          data: { opt: "getSubstituteStats" },
          dataType: "json",
          timeout: 10000,
          success: (res) => {
            $.LoadingOverlay("hide");
            if (res.status === "success" && res.data) {
              if (res.data.length === 0) {
                Swal.fire({
                  icon: "info",
                  title: "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥",
                  text: "‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö",
                  confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
                });
                return;
              }

              const stats = res.data;
              const labels = stats.map(item => item.nameTeacherSave);
              const data = stats.map(item => parseInt(item.totalPeriods, 10));

              const colors = [
                'rgba(74, 222, 128, 0.6)',  // Green
                'rgba(59, 130, 246, 0.6)',  // Blue
                'rgba(236, 72, 153, 0.6)',  // Pink
                'rgba(255, 159, 64, 0.6)',  // Orange
                'rgba(153, 102, 255, 0.6)', // Purple
                'rgba(255, 99, 132, 0.6)',  // Red
                'rgba(54, 162, 235, 0.6)',  // Sky Blue
                'rgba(255, 206, 86, 0.6)',  // Yellow
                'rgba(75, 192, 192, 0.6)',  // Teal
                'rgba(173, 181, 189, 0.6)', // Gray
                'rgba(255, 105, 180, 0.6)', // Hot Pink
                'rgba(0, 206, 209, 0.6)',   // Cyan
                'rgba(124, 252, 0, 0.6)',   // Lime Green
                'rgba(238, 130, 238, 0.6)', // Violet
                'rgba(210, 105, 30, 0.6)'   // Chocolate
              ];
              const borderColors = colors.map(color => color.replace('0.6', '1'));

              const ctx = document.getElementById("statsChart").getContext("2d");
              $("#chartContainer").removeClass("hidden");

              if (window.statsChartInstance) {
                window.statsChartInstance.destroy();
              }

              window.statsChartInstance = new Chart(ctx, {
                // type: "doughnut",
                type: "bar",
                data: {
                  labels: labels,
                  datasets: [{
                    label: "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô",
                    data: data,
                    backgroundColor: colors.slice(0, labels.length),
                    borderColor: borderColors.slice(0, labels.length),
                    borderWidth: 1
                  }]
                },
                options: {
                  plugins: {
                    legend: {
                      position: 'bottom',
                      labels: {
                        color: "#ffffff",
                        font: { size: 14 },
                        padding: 20
                      }
                    },
                    title: {
                      display: true,
                      text: "‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô‡∏ï‡∏≤‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏≠‡∏ô‡πÅ‡∏ó‡∏ô",
                      color: "#4ade80",
                      font: { size: 18 }
                    },
                    tooltip: {
                      callbacks: {
                        label: function(context) {
                          let label = context.label || '';
                          let value = context.parsed || 0;
                          return `${label}: ${value} ‡∏Ñ‡∏≤‡∏ö`;
                        }
                      }
                    }
                  },
                  responsive: true,
                  maintainAspectRatio: false,
                  cutout: '50%'
                }
              });

              document.getElementById("chartContainer").scrollIntoView({ behavior: "smooth" });
            } else {
              Swal.fire({
                icon: "error",
                title: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î",
                text: res.message || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÑ‡∏î‡πâ",
                confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
              });
            }
          },
          error: (err) => {
            console.error("Stats Error:", err);
            $.LoadingOverlay("hide");
            let errorMessage = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà";
            if (err.status === 0) {
              errorMessage = "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏£‡∏∑‡∏≠ URL ‡∏Ç‡∏≠‡∏á Google Apps Script";
            } else if (err.status === 404) {
              errorMessage = "‡πÑ‡∏°‡πà‡∏û‡∏ö Google Apps Script Endpoint ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö scriptUrl";
            } else if (err.status === 403) {
              errorMessage = "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Google Apps Script ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Web App";
            } else if (err.statusText === "timeout") {
              errorMessage = "‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏´‡∏°‡∏î‡πÄ‡∏ß‡∏•‡∏≤ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå";
            }
            Swal.fire({
              icon: "error",
              title: "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥",
              html: `${errorMessage}<br><small>URL: ${scriptUrl}?opt=getSubstituteStats</small>`,
              confirmButtonText: "‡∏ï‡∏Å‡∏•‡∏á",
            });
          }
        });
      }

      (() => {
        "use strict";
        const forms = document.querySelectorAll(".needs-validation");
        Array.from(forms).forEach((form) => {
          form.addEventListener(
            "submit",
            (event) => {
              event.preventDefault();
              if (!form.checkValidity()) {
                event.stopPropagation();
                form.classList.add("was-validated");
                $("#myForm").find(":invalid").first().focus();
              } else {
                submitForm();
              }
            },
            false
          );
        });
      })();
    </script>

    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@2.1.7/dist/loadingoverlay.min.js"></script>
  </body>
</html>
